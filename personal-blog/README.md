# Personal Blog (Flask Example)

A minimal personal blog built with Flask.

## Requirements

- Python 3.14+
-  Python package and project manager: [uv](https://docs.astral.sh/uv/)

Quick start
-----------
1. Create python virtual environment, and install dependencies:
   uv sync

2. Run the app (development):
   # Option A (run.py)
   uv run run.py

   # Option B (Flask CLI)
   uv run flask --app "app:create_app" run --reload

Database & CLI
--------------
The project uses SQLAlchemy with SQLite by default (sqlite:///blog.db).

Provided Flask CLI commands (use Flask CLI so the factory is invoked):
  flask --app "app:create_app" init-db
  flask --app "app:create_app" create-db
  flask --app "app:create_app" delete-db
  flask --app "app:create_app" add-user <username>
  flask --app "app:create_app" list-user
  flask --app "app:create_app" list-post [--user <username>]
  flask --app "app:create_app" change-password <username>
  flask --app "app:create_app" delete-user <username>

Notes and gotchas
-----------------
- init-db will DROP all tables and recreate them. Do not run in production.
- SQLite requires PRAGMA foreign_keys=ON for ON DELETE CASCADE to work. The project enables this for sqlite connections.
- For schema changes use a migration tool (recommended: Flask-Migrate or Alembic).
- Review autogenerated migration scripts before applying in production.

Routes
------
Routes are defined in `app/admin.py` (admin blueprint) and `app/guest.py` (public/guest blueprint). Admin routes require login (session keys: `user`, `user_id`).

Admin routes (blueprint name: `admin`):
- GET,POST  /login                  — login form and submit
- GET       /logout                 — logout, clears session
- GET       /admin                  — admin dashboard (user's posts)
- GET,POST  /new                    — create new post
- GET,POST  /edit/<int:post_id>     — edit an existing post
- GET       /delete/<int:post_id>   — delete a post
- GET       /preview/<int:post_id>  — view a single post (admin view)

Public/guest routes:
- See `app/guest.py` for the exact list. Typical routes in guest blueprint include:
  - GET /                     — home page, lists all posts
  - GET /home                 — home page, lists all posts
  - GET /article/<int:id>     — view a single post

If you add or change routes, update `app/guest.py` or `app/admin.py` and reflect the changes here.

Migrations
----------
- Recommended for Flask: Flask-Migrate (wrapper around Alembic).
  pip install Flask-Migrate alembic

- Quick setup in your app factory:
    from flask_migrate import Migrate
    migrate = Migrate()
    migrate.init_app(app, db, render_as_batch=True)

  `render_as_batch=True` helps work around some SQLite ALTER limitations during autogeneration.

